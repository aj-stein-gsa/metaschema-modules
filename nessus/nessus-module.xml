<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="https://raw.githubusercontent.com/usnistgov/metaschema/develop/schema/xml/metaschema.xsd" type="application/xml" schematypens="http://www.w3.org/2001/XMLSchema"?>
<METASCHEMA xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0">
    <schema-name>Tenable Nessus Metaschema Module</schema-name>
    <schema-version>0.1.0</schema-version>
    <!-- 
        Developer docs and forum posts mention the namespace:
        https://developer.tenable.com/docs/export-file-formats
        https://community.tenable.com/s/question/0D5f200004rM1i0CAC/nessus-xml-xsd
    -->
    <short-name>nessus</short-name>
    <namespace>http://www.nessus.org/cm</namespace>
    <json-base-uri>http://www.nessus.org/cm</json-base-uri>
    <define-assembly name="client-data">
        <!-- Documents and community posts evidence NessusClientData and NessusClientData_v2, we use the latter for now. -->
        <root-name>NessusClientData_v2</root-name>
        <model>
            <assembly ref="Policy" min-occurs="0" max-occurs="1"/>
            <assembly ref="Report" min-occurs="0" max-occurs="1"/>
        </model>
    </define-assembly>
    <define-assembly name="Policy">
        <model>
            <define-field name="PolicyName" as-type="string"/>
            <define-field name="PolicyComments" as-type="string"/>
            <assembly ref="Preferences"/>
        </model>
    </define-assembly>
    <define-assembly name="Report">
        <define-flag name="name" as-type="string"/>
    </define-assembly>
    <define-assembly name="Preferences">
        <model>
            <assembly ref="ServerPreferences"/>
            <assembly ref="PluginPreferences"/>
        </model>
    </define-assembly>
    <define-assembly name="FamilyItem">
        <model>
            <define-field name="FamilyName" as-type="string"/>
            <define-field name="Status" as-type="string"/>
        </model>
    </define-assembly>
    <define-assembly name="PluginItem">
        <model>
            <define-field name="PluginId" as-type="string"/>
            <define-field name="PluginName" as-type="string"/>
            <define-field name="Family" as-type="string"/>
            <define-field name="Status" as-type="string"/>
        </model>
    </define-assembly>
    <define-assembly name="PluginPreferences">
        <model>
            <define-assembly name="item">
                <model>
                    <define-field name="pluginName" as-type="string"/>
                    <define-field name="pluginId" as-type="string"/>
                    <define-field name="fullName" as-type="string"/>
                    <define-field name="preferenceName" as-type="string"/>
                    <define-field name="preferenceType" as-type="string"/>
                    <define-field name="preferenceValues" as-type="string"/>
                    <define-field name="selectedValue" as-type="string"/>
                </model>
            </define-assembly>
        </model>
    </define-assembly>    
    <define-assembly name="ServerPreferences">
        <model>
            <define-field name="name" as-type="string"/>
            <define-field name="value" as-type="string"/>
        </model>
    </define-assembly>
</METASCHEMA>
